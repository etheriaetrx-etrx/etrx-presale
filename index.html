<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>$ETRX • Etheria Presale</title>
<meta name="description" content="$ETRX — the official utility token of Etheria. Presale on Ethereum."/>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="0"/>

<!-- Canonical & Social -->
<link rel="canonical" href="https://etheriaetrx-etrx.github.io/etrx-presale/">
<meta property="og:site_name" content="Etheria">
<meta property="og:title" content="$ETRX • Etheria Presale">
<meta property="og:description" content="The official utility token of Etheria. Presale runs Sep 24 → Oct 1, 2025 (UTC).">
<meta property="og:type" content="website">
<meta property="og:url" content="https://etheriaetrx-etrx.github.io/etrx-presale/">
<meta property="og:image" content="https://etheriaetrx-etrx.github.io/etrx-presale/assets/Background.png">
<meta property="og:image:width" content="1280">
<meta property="og:image:height" content="720">
<meta property="og:locale" content="en_US">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ETRXDreamscapes">
<meta name="twitter:image" content="https://etheriaetrx-etrx.github.io/etrx-presale/assets/Background.png">
<meta name="twitter:image:alt" content="Etheria presale hero art">

<!-- CSP (single-file build) -->
<meta http-equiv="Content-Security-Policy"
  content="default-src 'self' https://etheriaetrx-etrx.github.io;
           img-src 'self' data: https:;
           script-src 'self' https://cdn.tailwindcss.com https://cdn.jsdelivr.net 'unsafe-inline';
           style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
           font-src https://fonts.gstatic.com;
           connect-src 'self' https://formspree.io https://cloudflare-eth.com;
           worker-src 'self';
           object-src 'none';
           base-uri 'self';
           frame-ancestors 'none';
           upgrade-insecure-requests">
<meta name="theme-color" content="#05070d">
<meta name="robots" content="index,follow,max-image-preview:large"/>

<!-- Performance -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net">

<!-- Fonts & Libraries -->
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<script>
  window.tailwind = {}
  tailwind.config = { theme:{ extend:{
    fontSize:{ 'hero':'clamp(2.25rem, 4vw + 1rem, 3.75rem)' },
    maxWidth:{ 'measure':'65ch' }
  }}}
</script>
<script src="https://cdn.tailwindcss.com?v=3" defer></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js" defer></script>

<!-- Assets -->
<link rel="preload" as="image" href="assets/Background.png">
<link rel="icon" type="image/png" href="assets/logo.png">

<style>
:root{
  color-scheme: dark;
  --bg:#05070d; --panel:rgba(255,255,255,.06); --ring:rgba(0,255,255,.18);
  --dim:rgba(255,255,255,.72); --muted:rgba(255,255,255,.9);
  --neon-cyan: 0 255 255; --neon-blue: 84 178 255; --neon-violet: 208 128 255; --neon-orange: 255 147 76;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:#fff;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;overflow-x:hidden}

/* Layers */
main, section, header, footer, .glass, .card { position:relative; z-index:2; isolation:isolate }
.scanlines { position:fixed; inset:0; z-index:0; pointer-events:none; background: repeating-linear-gradient( to bottom, rgba(255,255,255,.03), rgba(255,255,255,.03) 1px, transparent 2px, transparent 4px ); mix-blend-mode: soft-light; opacity:.18; }

/* Aurora background */
#bgAurora{
  position:fixed; inset:0; z-index:0; pointer-events:none; overflow:hidden;
  background:
    radial-gradient(120% 60% at 50% -10%, rgba(0,255,255,.10), transparent 60%),
    radial-gradient(80% 50% at 20% 10%, rgba(84,178,255,.12), transparent 60%),
    radial-gradient(80% 50% at 80% 15%, rgba(255,147,76,.10), transparent 60%);
}
#bgAurora::before,
#bgAurora::after{
  content:""; position:absolute; inset:-20%; pointer-events:none; filter: blur(24px) saturate(1.1);
  mix-blend-mode:screen; opacity:.45;
  background:
    conic-gradient(from 0deg at 50% 50%,
      rgba(0,255,255,.28),
      rgba(84,178,255,.28),
      rgba(208,128,255,.26),
      rgba(255,147,76,.22),
      rgba(0,255,255,.28));
  animation: auroraSweep 28s linear infinite;
}
#bgAurora::after{
  opacity:.30; filter: blur(34px);
  background:
    radial-gradient(120% 120% at 30% 20%, rgba(0,255,255,.22), transparent 55%),
    radial-gradient(120% 120% at 70% 25%, rgba(208,128,255,.16), transparent 55%),
    radial-gradient(140% 100% at 50% -10%, rgba(84,178,255,.18), transparent 60%);
  animation: auroraDrift 22s ease-in-out infinite alternate;
}
@keyframes auroraSweep { to { transform: rotate(360deg); } }
@keyframes auroraDrift { from { transform: translateY(-3%) } to { transform: translateY(3%) } }

/* Wisps canvas */
#wispCanvas{ position:fixed; inset:0; z-index:1; pointer-events:none; }

/* Neon text */
.neon-text{
  text-shadow: 0 0 6px rgba(var(--neon-cyan)/.8), 0 0 24px rgba(var(--neon-blue)/.45), 0 0 48px rgba(var(--neon-violet)/.35);
}
.neon-grad{
  background: linear-gradient(90deg, rgb(var(--neon-orange)), rgb(var(--neon-blue)));
  -webkit-background-clip:text; background-clip:text; color:transparent;
  background-size:200% 100%; animation: sweep 6s linear infinite;
}
@keyframes sweep{ to{ background-position:-200% 0 } }

/* Links laser underline */
a.laser{ background: linear-gradient(90deg, #00ffff 0 0) bottom left / 0 2px no-repeat; transition: background-size .3s ease; }
a.laser:hover{ background-size: 100% 2px; text-shadow:0 0 10px #00ffff66 }

/* Cards */
.glass{backdrop-filter: blur(12px); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border:1px solid var(--ring)}
.card{
  border-radius:18px; box-shadow: 0 0 0 1px rgba(0,255,255,.08) inset, 0 8px 30px rgba(0,255,255,.08), 0 0 60px rgba(130,200,255,.06);
  transition: transform .2s ease, box-shadow .25s ease;
}
.card:hover{ transform: translateY(-2px) }
.card:active{ transform: translateY(0) scale(.997) }
.card:focus-within{ box-shadow: 0 0 0 2px rgba(0,255,255,.25), 0 8px 30px rgba(0,255,255,.08) }
.card-outline{position:relative}
.card-outline::before{
  content:""; position:absolute; inset:-1px; border-radius:inherit; pointer-events:none;
  background: conic-gradient(from 180deg at 50% 50%, rgba(var(--neon-orange)/.7), rgba(var(--neon-blue)/.7), rgba(var(--neon-violet)/.7), rgba(var(--neon-orange)/.7));
  -webkit-mask: linear-gradient(#000 0 0) padding-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude;
  filter: blur(8px) saturate(1.4); opacity:.35; animation: spinBorder 10s linear infinite;
}
@keyframes spinBorder { to { transform: rotate(360deg) } }

/* Holo hover (pointer-follow glow) */
.holo{ position:relative; overflow:hidden }
.holo::before{
  content:""; position:absolute; inset:-1px; pointer-events:none; border-radius:inherit;
  background:
    radial-gradient(240px circle at var(--mx,50%) var(--my,50%), rgba(84,178,255,.22), transparent 45%),
    radial-gradient(360px circle at var(--mx,50%) var(--my,50%), rgba(208,128,255,.18), transparent 55%),
    radial-gradient(520px circle at var(--mx,50%) var(--my,50%), rgba(255,147,76,.14), transparent 60%);
  mix-blend-mode:screen; opacity:.45; transition: opacity .18s ease;
}
.holo:hover::before{ opacity:.7 }
/* Optional sweeping sheen */
.holo::after{
  content:""; position:absolute; inset:-160% -160%;
  background: conic-gradient(from 0deg, #fff0, #fff3 10%, #fff0 20%), linear-gradient(120deg, #ff934c44, #54b2ff44, #d080ff44);
  mix-blend-mode:screen; filter:saturate(1.3) blur(10px); opacity:.25; pointer-events:none;
  transform:translateX(-30%); transition: transform .8s ease, opacity .3s ease;
}
.holo:hover::after{ transform:translateX(30%); opacity:.45 }

/* Buttons */
.btn-primary{
  position:relative; display:inline-flex; align-items:center; gap:.55rem; padding:.75rem 1rem;
  border-radius:14px; font-weight:800; color:#02040a;
  background:linear-gradient(90deg, rgb(var(--neon-orange)), rgb(var(--neon-blue)));
  box-shadow: 0 0 16px rgba(255,147,76,.45), 0 0 24px rgba(84,178,255,.35);
}
.btn-primary:hover{ transform: translateY(-1px) scale(1.01) }
.btn-ghost{ border:1px solid rgba(0,255,255,.25); background: rgba(255,255,255,.03); padding:.6rem .9rem; border-radius:12px; }
.hidden-important{ display:none !important }
.small-dim{ color:var(--dim) }
.title-glow{ text-shadow:0 0 14px rgba(0,255,255,.3), 0 0 36px rgba(84,178,255,.25) }
.tabular{ font-variant-numeric: tabular-nums }

/* Header elevation */
.header-float{ backdrop-filter: blur(10px); background:rgba(4,7,12,.5); border-bottom:1px solid rgba(0,255,255,.12); transition: background .2s ease }

/* FAQ */
.faq-item{ border:1px solid #00ffff22; border-radius:14px; overflow:hidden }
.faq-header{ position:relative; width:100%; display:flex; align-items:center; justify-content:space-between; gap:.75rem; padding:1rem 1.25rem; text-align:left }
.faq-header::after{ content:""; position:absolute; left:0; right:0; bottom:0; height:1px; background: linear-gradient(90deg, #00ffff44, transparent); pointer-events:none }
.faq-body{ padding: 0 1.25rem; max-height:0; transition:max-height .28s ease, padding .2s ease }
.faq-body.open { padding: .25rem 1.25rem 1rem; }
.faq-chevron { transition: transform .25s ease }
.faq-item.open{ box-shadow:0 0 24px #00ffff22 inset }

/* Hero glow */
.hero-vignette{ position:absolute; inset:0; pointer-events:none; background: radial-gradient(80% 60% at 50% 10%, transparent 0 60%, rgba(0,0,0,.35) 100%); z-index:1 }
.hero-glow{ position:relative; border-radius:1.5rem; overflow:visible; }
.hero-glow::before,
.hero-glow::after{
  content:""; position:absolute; border-radius:inherit; pointer-events:none; inset:-22px;
  mix-blend-mode:screen;
}
.hero-glow::before{
  background: conic-gradient(from 0deg at 50% 50%,
    rgba(0,255,255,.32),
    rgba(84,178,255,.36),
    rgba(208,128,255,.34),
    rgba(255,147,76,.30),
    rgba(0,255,255,.32));
  filter: blur(46px) saturate(1.35) brightness(1.05);
  opacity:.55; animation: glowSpin 18s linear infinite;
}
.hero-glow::after{
  background: radial-gradient(120% 120% at 50% 50%,
    rgba(0,255,255,.22),
    rgba(84,178,255,.18) 35%,
    rgba(208,128,255,.14) 60%,
    rgba(255,147,76,.12) 75%,
    transparent 85%);
  filter: blur(36px) saturate(1.15);
  opacity:.42; animation: glowPulse 7.5s ease-in-out infinite alternate;
}
.hero-glow img{
  position:relative; display:block; border-radius:inherit;
  box-shadow:
    0 0 0 1px rgba(0,255,255,.22) inset,
    0 22px 60px rgba(84,178,255,.18),
    0 0 80px rgba(0,255,255,.18);
}
@keyframes glowSpin { to { transform: rotate(360deg); } }
@keyframes glowPulse { from { opacity:.32; filter: blur(28px); } to { opacity:.48; filter: blur(40px); } }

/* Badges + table */
.badge{ display:inline-flex; align-items:center; gap:.4rem; padding:.15rem .5rem; border-radius:.5rem; font-size:.7rem; font-weight:700; letter-spacing:.02em }
.badge-now{ background:rgba(16,185,129,.18); border:1px solid rgba(16,185,129,.35); color:#a7f3d0 }
.row{ display:grid; grid-template-columns: 1fr auto auto; gap:.75rem; align-items:center }
.row + .row{ border-top:1px solid rgba(255,255,255,.08); padding-top:.5rem; margin-top:.5rem }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{ animation-duration:.001ms !important; animation-iteration-count:1 !important; transition:none !important }
  #bgAurora::before, #bgAurora::after, .card-outline::before, .holo::after, .hero-glow::before, .hero-glow::after{ display:none }
}
</style>
</head>
<body>
<noscript>
  <div style="position:relative;z-index:3;margin:1rem auto;max-width:60rem;padding:.75rem 1rem;border:1px solid #0ff3;border-radius:10px;background:#06121a;color:#bfefff;font:14px/1.3 Inter,system-ui">
    JavaScript is disabled — countdown and forms require it.
  </div>
</noscript>

<!-- Background & layers -->
<div id="bgAurora" aria-hidden="true"></div>
<canvas id="wispCanvas" aria-hidden="true"></canvas>
<div class="scanlines" aria-hidden="true"></div>

<a href="#about" class="skip-link sr-only focus:not-sr-only focus:fixed focus:left-4 focus:top-4 focus:z-50 focus:rounded-md focus:bg-cyan-400 focus:px-3 focus:py-2 focus:text-black">Skip to content</a>

<header id="siteHeader" class="relative z-10 mx-auto flex max-w-6xl items-center justify-between px-6 py-5">
  <div class="flex items-center gap-3">
    <img src="assets/logo.png" alt="Etheria Logo" class="h-10 w-10 rounded-xl ring-1 ring-cyan-400/20 object-contain bg-white/5"/>
    <div class="text-sm tracking-wide small-dim">Etheria</div>
  </div>
  <nav class="hidden gap-6 text-sm opacity-80 md:flex" aria-label="Primary">
    <a class="laser hover:opacity-100" href="#about">About</a>
    <a class="laser hover:opacity-100" href="#token">Tokenomics</a>
    <a class="laser hover:opacity-100" href="#road">Road</a>
    <a class="laser hover:opacity-100" href="#faq">FAQ</a>
  </nav>
  <div class="flex items-center gap-3">
    <button id="connectBtn" class="btn-primary text-sm" aria-haspopup="dialog" aria-controls="walletModal">Connect Wallet</button>
    <div id="walletPill" class="btn-ghost text-xs hidden" aria-live="polite">
      <span id="walletShort" class="addr"></span>
      <button id="disconnectBtn" class="ml-2 underline underline-offset-4">Disconnect</button>
    </div>
  </div>
</header>

<!-- Wallet modal -->
<div id="walletModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 p-4"
     role="dialog" aria-modal="true" aria-labelledby="walletModalTitle" inert>
  <div class="glass card card-outline w-[min(420px,92vw)] p-4" data-modal-surface>
    <div class="flex items-center justify-between">
      <h3 id="walletModalTitle" class="text-lg font-semibold neon-text">Choose a wallet</h3>
      <button id="modalClose" class="text-white/70 hover:text-white" aria-label="Close dialog">✕</button>
    </div>
    <p class="mt-1 text-xs small-dim">Use a browser wallet (MetaMask, Rabby, Brave, Frame, etc.).</p>
    <div id="walletList" class="mt-4 grid gap-2" role="list"></div>
    <p class="mt-2 text-xs small-dim">Tip: If nothing shows up, install a wallet extension or use a browser with a built-in wallet.</p>
  </div>
</div>

<!-- Hero -->
<section class="hero relative z-10 mx-auto grid max-w-6xl grid-cols-1 items-stretch gap-10 px-6 pb-16 pt-6 md:grid-cols-2 md:pt-10">
  <div class="hero-vignette" aria-hidden="true"></div>

  <!-- Left: copy, countdown, pricing -->
  <div class="order-2 md:order-1">
    <h1 class="title-glow neon-text text-hero leading-tight md:text-6xl">
      The Official Token of Etheria<br/>
      <span class="neon-grad">$ETRX Presale</span>
    </h1>
    <p class="mt-4 max-w-measure small-dim">Powering realms, artifacts, governance and community rewards. Built on Ethereum for permanence and reach.</p>

    <!-- Countdown + phase + progress -->
    <div class="mt-8 glass card card-outline p-5 reveal holo" data-delay="0">
      <div id="phaseLabel" class="mb-2 text-xs uppercase tracking-[.15em] small-dim">Presale begins in — <span id="modeLabel">UTC</span></div>
      <div id="countdown" class="flex gap-3 text-center" aria-live="polite"></div>

      <div class="mt-3 text-xs flex flex-col gap-1 small-dim">
        <div id="whenPrimary" class="text-sm text-white/90"></div>
        <div id="whenSecondary"></div>
        <button id="tzToggle" class="mt-2 self-start underline underline-offset-4 opacity-90 hover:opacity-100" aria-pressed="false">Make Local primary</button>
      </div>

      <!-- Overall Progress -->
      <div class="mt-4">
        <div class="flex items-center justify-between text-xs small-dim">
          <span id="phaseName" class="font-semibold">Phase: Presale</span><span id="phaseEta"></span>
        </div>
        <div class="mt-2 h-2 w-full overflow-hidden rounded-full bg-white/10">
          <div id="phaseBar" class="h-full" style="background:linear-gradient(90deg, rgba(var(--neon-orange),1), rgba(var(--neon-blue),1)); width:0%"></div>
        </div>
        <div class="mt-1 text-xs small-dim" id="phaseDates"></div>
      </div>

      <!-- Tiered Pricing cards -->
      <div class="mt-5 grid gap-3 sm:grid-cols-2">
        <div class="glass card card-outline p-4 holo">
          <div class="text-xs uppercase small-dim">Current Phase Price</div>
          <div id="priceNow" class="mt-1 text-2xl font-extrabold text-green-400">$0.08</div>
          <div id="pricePhaseName" class="text-xs small-dim mt-1">Phase 1</div>
        </div>
        <div class="glass card card-outline p-4 holo">
          <div class="text-xs uppercase small-dim">Planned Listing Price</div>
          <div id="priceList" class="mt-1 text-xl font-bold text-white line-through">$0.12</div>
          <div id="discountLine" class="text-xs small-dim mt-1">33% below listing</div>
        </div>

        <div class="sm:col-span-2 glass card card-outline p-4 holo">
          <div class="text-xs uppercase small-dim mb-2">Quick calculator</div>
          <label class="text-xs small-dim" for="usdIn">Amount (USD)</label>
          <input id="usdIn" type="number" min="0" step="0.01"
                 class="mt-1 w-full rounded-lg bg-white/5 border border-white/10 px-3 py-2 outline-none placeholder:text-white/40"
                 placeholder="100.00"/>
          <div class="mt-2 text-sm">
            ≈ <span id="tokensOut" class="font-semibold">0</span> ETRX @ <span id="calcPrice">$0.08</span>
          </div>
        </div>

        <!-- Phase schedule table -->
        <div class="sm:col-span-2 glass card card-outline p-4 holo">
          <div class="flex items-center justify-between">
            <div class="text-xs uppercase small-dim">Phase schedule</div>
            <div id="phaseScheduleTz" class="text-[11px] small-dim opacity-80">Times in UTC</div>
          </div>
          <div id="phaseTable" class="mt-2"></div>
        </div>
      </div>
    </div>

    <ul class="mt-6 grid grid-cols-2 gap-3 text-sm sm:text-base">
      <li class="glass card card-outline holo p-4 reveal" data-delay="50"><span class="inline-block w-2 h-2 rounded-full bg-cyan-400 mr-2"></span>Supply: <b>10,000,000</b></li>
      <li class="glass card card-outline holo p-4 reveal" data-delay="100"><span class="inline-block w-2 h-2 rounded-full bg-cyan-400 mr-2"></span>Network: <b>Ethereum</b></li>
      <li class="glass card card-outline holo p-4 reveal" data-delay="150"><span class="inline-block w-2 h-2 rounded-full bg-cyan-400 mr-2"></span>Symbol: <b>ETRX</b></li>
      <li class="glass card card-outline holo p-4 reveal" data-delay="200"><span class="inline-block w-2 h-2 rounded-full bg-cyan-400 mr-2"></span>Presale: <b>Sep 24 → Oct 1</b></li>
    </ul>

    <div class="mt-4 text-xs small-dim">
      <b>What happens next?</b> After the presale window closes, we proceed to Token Generation Event (TGE), distribution, and initial listings/liquidity.
    </div>

    <div class="mt-6 flex flex-wrap items-center gap-3 text-sm small-dim">
      <span>Follow updates:</span>
      <a class="laser hover:text-white" href="https://x.com/ETRXDreamscapes" target="_blank" rel="noopener noreferrer">Twitter</a>
    </div>
    <div class="mt-4 flex flex-wrap items-center gap-3">
      <button id="shareLaunch" class="btn-primary text-sm"><span>Share this launch</span></button>
      <button id="openConnect" class="btn-ghost text-sm" aria-haspopup="dialog" aria-controls="walletModal">Connect Wallet</button>
    </div>
  </div>

  <!-- Right: hero image -->
  <div class="order-1 md:order-2 h-[360px] md:h-[560px] lg:h-[620px] reveal" data-delay="0">
    <div class="hero-glow h-full w-full rounded-3xl">
      <img
        src="assets/Background.png"
        alt="Etheria Background"
        width="1280" height="720"
        class="h-full w-full rounded-3xl ring-1 ring-cyan-400/15 object-cover"
        loading="eager" decoding="async" fetchpriority="high"
        onerror="this.outerHTML='<div class=&quot;h-full w-full rounded-3xl ring-1 ring-white/10 bg-gradient-to-br from-cyan-500/10 via-blue-500/10 to-orange-500/10 flex items-center justify-center text-white/50&quot;>Background image missing</div>'"/>
    </div>
  </div>
</section>

<div class="section-divider max-w-6xl mx-auto"></div>

<!-- About -->
<section id="about" class="relative z-10 mx-auto max-w-6xl px-6 py-12">
  <h2 class="text-2xl font-bold neon-text reveal">What is $ETRX?</h2>
  <p class="mt-3 max-w-3xl small-dim reveal" data-delay="50">
    $ETRX is the utility token of Etheria — used to unlock rare Realms &amp; Artifacts, vote on lore and direction,
    access exclusive drops, and power the Etherian economy. Holders may receive airdrops and in-world benefits.
  </p>
</section>

<div class="section-divider max-w-6xl mx-auto"></div>

<!-- Tokenomics -->
<section id="token" class="relative z-10 mx-auto max-w-6xl px-6">
  <h2 class="text-2xl font-bold neon-text reveal">Tokenomics (Overview)</h2>
  <div class="mt-5 grid grid-cols-1 gap-4 md:grid-cols-3">
    <div class="glass card card-outline holo p-5 reveal" data-delay="0"><b>Utility</b><br/><span class="small-dim">Access to Realms &amp; Artifacts, governance votes, allowlists, and in-world boosts.</span></div>
    <div class="glass card card-outline holo p-5 reveal" data-delay="50"><b>Distribution Model</b><br/><span class="small-dim">Phased: presale participants, ecosystem growth, contributors, liquidity, reserves.</span></div>
    <div class="glass card card-outline holo p-5 reveal" data-delay="100"><b>Lockups &amp; Cliff</b><br/><span class="small-dim">Contributor and reserve tranches unlock gradually to align long-term incentives.</span></div>
    <div class="glass card card-outline holo p-5 reveal" data-delay="150"><b>Emissions</b><br/><span class="small-dim">No hard farming emissions at launch; rewards focus on quests and on-chain participation.</span></div>
    <div class="glass card card-outline holo p-5 reveal" data-delay="200"><b>Liquidity Approach</b><br/><span class="small-dim">Initial pools post-TGE with transparent on-chain adds; bridge exploration comes later.</span></div>
    <div class="glass card card-outline holo p-5 reveal" data-delay="250"><b>Governance</b><br/><span class="small-dim">Progressive decentralization — votes start with lore/world decisions.</span></div>
  </div>
  <p class="mt-3 text-xs small-dim reveal" data-delay="300">Note: Detailed allocations/percentages will be shared closer to TGE.</p>
</section>

<div class="section-divider max-w-6xl mx-auto"></div>

<!-- Road -->
<section id="road" class="relative z-10 mx-auto max-w-6xl px-6 py-14">
  <h2 class="text-2xl font-bold neon-text reveal">Road to Mainnet</h2>
  <ol class="mt-5 grid grid-cols-1 gap-4 sm:grid-cols-2 small-dim">
    <li class="glass card card-outline holo p-4 reveal" data-delay="0">1) Launch site &amp; whitelist open</li>
    <li class="glass card card-outline holo p-4 reveal" data-delay="50">2) Community reveal + partnerships</li>
    <li class="glass card card-outline holo p-4 reveal" data-delay="100">3) Presale window opens (this page)</li>
    <li class="glass card card-outline holo p-4 reveal" data-delay="150">4) TGE: distribution to presale wallets</li>
    <li class="glass card card-outline holo p-4 sm:col-span-2 reveal" data-delay="200">5) Initial listings + liquidity + bridge planning</li>
  </ol>
</section>

<div class="section-divider max-w-6xl mx-auto"></div>

<!-- Notify & Allowlist -->
<section id="notify" class="relative z-10 mx-auto max-w-6xl px-6 pb-24">
  <div class="glass card card-outline holo p-6 reveal">
    <h3 class="text-xl font-semibold neon-text">Get notified when the presale opens</h3>

    <form id="notifyForm" class="mt-4 flex flex-col gap-3 sm:flex-row"
          action="https://formspree.io/f/mandalyp" method="POST" data-formspree="true" novalidate autocomplete="on">
      <label class="sr-only" for="email">Email</label>
      <input required id="email" name="email" type="email" placeholder="you@example.com" autocomplete="email"
             class="flex-1 rounded-2xl border border-cyan-400/20 bg-white/5 px-4 py-3 outline-none placeholder:text-white/40 focus:ring-2 focus:ring-cyan-400"/>
      <!-- Honeypot -->
      <input type="text" name="company" class="hidden" tabindex="-1" autocomplete="off" />
      <input type="hidden" name="form_name" value="notify"/>
      <input type="hidden" name="_redirect" value="https://etheriaetrx-etrx.github.io/etrx-presale/#notify-success">
      <button class="btn-primary" type="submit">Notify Me</button>
    </form>

    <div id="notifySuccess" class="hidden mt-4 glass card p-5" role="status" aria-live="polite" aria-atomic="true">
      <div class="text-sm">✅ Thanks! Please check your inbox to confirm your email.</div>
      <div class="mt-1 text-xs small-dim">Tip: If you don’t see it, look in spam/promotions.</div>
    </div>

    <p id="notifyMsg" class="mt-2 text-xs hidden small-dim" aria-live="polite" aria-atomic="true"></p>
    <p class="mt-1 text-xs small-dim">We only use your info for presale notifications. No spam.</p>

    <div class="mt-8">
      <h4 class="text-base font-semibold neon-text">Join the allowlist</h4>
      <form id="wlForm" class="mt-3 grid gap-3 sm:grid-cols-[1fr_auto]"
            action="https://formspree.io/f/mandalyp" method="POST" data-formspree="true" novalidate>
        <label class="sr-only" for="wallet">Ethereum wallet or ENS</label>
        <input id="wallet" name="wallet" inputmode="text" autocomplete="off" placeholder="0x… or yourname.eth" spellcheck="false"
               class="rounded-2xl border border-cyan-400/20 bg-white/5 px-4 py-3 outline-none placeholder:text-white/40 focus:ring-2 focus:ring-cyan-400" />
        <input type="text" name="company" class="hidden" tabindex="-1" autocomplete="off" />
        <input type="hidden" name="type" value="allowlist" />
        <button class="btn-primary" type="submit">Join Allowlist</button>
      </form>

      <p id="wlHelp" class="mt-2 text-xs small-dim"></p>
      <div id="wlSuccess" class="hidden mt-3 glass card p-5 sm:col-span-2" role="status" aria-live="polite" aria-atomic="true">
        <div class="text-sm">✅ Wallet submitted! We’ll verify allowlist details before presale.</div>
        <div class="mt-1 text-xs small-dim">You’ll be notified by email before the window opens.</div>
      </div>
      <p id="wlMsg" class="mt-2 text-xs hidden small-dim" aria-live="polite" aria-atomic="true"></p>
    </div>
  </div>
</section>

<!-- FAQ -->
<section id="faq" class="relative z-10 mx-auto max-w-6xl px-6 pb-8">
  <h2 class="text-2xl font-bold neon-text reveal">FAQ</h2>
  <div class="mt-4 grid gap-3">
    <div class="faq-item reveal">
      <button class="faq-header" aria-expanded="false" aria-controls="faq-when-body" id="faq-when-btn">
        <span>When does the presale run?</span>
        <span class="faq-chevron" aria-hidden="true">⌄</span>
      </button>
      <div class="faq-body" id="faq-when-body" role="region" aria-labelledby="faq-when-btn" hidden>
        <p class="small-dim">Sep 24 → Oct 1, 2025 (UTC). Use the toggle to view local time.</p>
      </div>
    </div>
    <div class="faq-item reveal">
      <button class="faq-header" aria-expanded="false" aria-controls="faq-tge-body" id="faq-tge-btn">
        <span>Will there be a TGE?</span>
        <span class="faq-chevron" aria-hidden="true">⌄</span>
      </button>
      <div class="faq-body" id="faq-tge-body" role="region" aria-labelledby="faq-tge-btn" hidden>
        <p class="small-dim">Yes—after the presale window closes, we’ll distribute to presale wallets and seed initial listings/liquidity.</p>
      </div>
    </div>
  </div>
</section>

<footer class="relative z-10 border-t border-cyan-400/15 py-10 small-dim">
  <div class="mx-auto flex max-w-6xl flex-col items-center justify-between gap-3 px-6 text-sm">
    <div>© <span id="year"></span> Etheria • $ETRX</div>
    <div class="flex items-center gap-4"><a class="laser hover:text-white" href="https://x.com/ETRXDreamscapes" target="_blank" rel="noopener noreferrer">Twitter</a></div>
    <p class="mt-2 max-w-3xl text-center text-xs opacity-80">
      Disclaimer: This site and presale information are for community use only and do not constitute an offer to sell or a solicitation to buy any financial instrument. Participation may be restricted by local laws. Crypto assets are volatile and carry risk.
    </p>
  </div>
</footer>

<a href="#notify" id="stickyCTA" class="fixed left-1/2 bottom-4 z-50 hidden -translate-x-1/2 rounded-full px-5 py-3 text-sm btn-primary shadow-lg">Get notified for $ETRX</a>

<!-- Schema.org event (SEO) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Event",
  "name": "ETRX Presale",
  "startDate": "2025-09-24T00:00:00Z",
  "endDate": "2025-10-01T00:00:00Z",
  "eventStatus": "https://schema.org/EventScheduled",
  "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode",
  "url": "https://etheriaetrx-etrx.github.io/etrx-presale/",
  "image": "https://etheriaetrx-etrx.github.io/etrx-presale/assets/Background.png",
  "organizer": { "@type": "Organization", "name": "Etheria" },
  "description": "Etheria’s official $ETRX presale on Ethereum."
}
</script>

<!-- App JS (countdown, phases, forms, wallet, etc.) -->
<script>
'use strict'
/* ================== CONFIG: DATES + TIERS ================== */
const PRESALE_START = new Date('2025-09-24T00:00:00Z');
const PRESALE_END   = new Date('2025-10-01T00:00:00Z');
const LISTING_PRICE = 0.12; // USD

/* Phases (edit these) */
const PHASES = [
  { name:'Phase 1', start:'2025-09-24T00:00:00Z', end:'2025-09-26T23:59:59Z', price:0.08 },
  { name:'Phase 2', start:'2025-09-27T00:00:00Z', end:'2025-09-28T23:59:59Z', price:0.10 },
  { name:'Phase 3', start:'2025-09-29T00:00:00Z', end:'2025-09-30T23:59:59Z', price:0.11 },
];

/* ================== DOM SHORTCUTS ================== */
const $ = (id)=> document.getElementById(id);
const phaseLabel=$('phaseLabel'), countdown=$('countdown'), whenPrimary=$('whenPrimary'),
      whenSecondary=$('whenSecondary'), modeLabel=$('modeLabel');
const connectBtn=$('connectBtn'), openConnect=$('openConnect'), modal=$('walletModal'), modalClose=$('modalClose');
const walletList=$('walletList'), walletPill=$('walletPill'), walletShort=$('walletShort'), disconnectBtn=$('disconnectBtn'), phaseNameEl=$('phaseName');
$('year').textContent = new Date().getFullYear();

/* Header elevation on scroll */
const header = document.getElementById('siteHeader');
addEventListener('scroll', ()=> header.classList.toggle('header-float', scrollY>12), {passive:true});

/* Time formatting */
const fmtBase = { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit', hour12:true };
const fmtUTC  = (d)=> d.toLocaleString([], { ...fmtBase, timeZone:'UTC', timeZoneName:'short' });
const fmtLoc  = (d)=> d.toLocaleString([], { ...fmtBase, timeZoneName:'short' });

/* localStorage helpers */
function safeGet(key, fallback=null){ try{ return localStorage.getItem(key) ?? fallback }catch{ return fallback } }
function safeSet(key, val){ try{ localStorage.setItem(key, val) }catch{} }

/* ================== UTC/LOCAL TOGGLE ================== */
let primaryUTC = (safeGet('etrx_tz', 'utc') || 'utc') === 'utc';
function updateWhen(){
  const s0 = new Date(PHASES[0].start), e0 = new Date(PHASES[0].end);
  if (primaryUTC){
    whenPrimary.textContent   = `Presale: ${fmtUTC(PRESALE_START)} → ${fmtUTC(PRESALE_END)}`;
    whenSecondary.textContent = `Local time: ${fmtLoc(PRESALE_START)} → ${fmtLoc(PRESALE_END)}`;
    modeLabel.textContent='UTC';
    tzToggle.textContent='Make Local primary';
    tzToggle.setAttribute('aria-pressed','false');
    $('phaseScheduleTz').textContent = 'Times in UTC';
  } else {
    whenPrimary.textContent   = `Presale: ${fmtLoc(PRESALE_START)} → ${fmtLoc(PRESALE_END)}`;
    whenSecondary.textContent = `UTC time: ${fmtUTC(PRESALE_START)} → ${fmtUTC(PRESALE_END)}`;
    modeLabel.textContent='Local';
    tzToggle.textContent='Make UTC primary';
    tzToggle.setAttribute('aria-pressed','true');
    $('phaseScheduleTz').textContent = 'Times in Local';
  }
  renderPhaseTable(); // keep table in sync with timezone change
}
const tzToggle = document.getElementById('tzToggle');
tzToggle?.addEventListener('click', ()=>{ primaryUTC=!primaryUTC; safeSet('etrx_tz', primaryUTC ? 'utc' : 'local'); updateWhen(); });

/* precision clock */
const t0 = Date.now(), p0 = performance.now();
const nowAccurate = ()=> new Date(t0 + (performance.now()-p0));

/* Phase helpers */
function clamp01(x){ return Math.max(0, Math.min(1, x)); }
function currentPhase(t=new Date()){
  for(const p of PHASES){ const s=new Date(p.start), e=new Date(p.end); if(t>=s && t<=e) return p; }
  if(t<PRESALE_START) return { pre:true };
  if(t>PRESALE_END) return { post:true };
  const nxt = PHASES.find(p=> t < new Date(p.start));
  return nxt ? {...nxt, upcoming:true} : { post:true };
}

/* Countdown UI block builder */
function box(v,label){
  const d=document.createElement('div');
  d.className='w-[5.5rem] rounded-xl glass card p-3 text-center';
  d.innerHTML=`<div class="text-3xl font-extrabold tabular neon-text">${String(v).padStart(2,'0')}</div><div class="text-[11px] uppercase small-dim">${label}</div>`;
  return d;
}

/* Dynamic pricing helpers */
function setPriceCard(price, label, listingActive=false, notStarted=false){
  const pct = Math.max(0, (1 - price/LISTING_PRICE)*100);
  $('priceNow').textContent = `$${price.toFixed(2)}`;
  $('calcPrice').textContent = `$${price.toFixed(2)}`;
  $('pricePhaseName').textContent = label + (listingActive ? ' (Active)' : notStarted ? ' (up next)' : '');
  const lp = $('priceList');
  if(listingActive){ lp.classList.remove('line-through'); lp.textContent = `$${LISTING_PRICE.toFixed(2)} (Active)`; $('discountLine').textContent = 'Listing live'; }
  else { if(!lp.classList.contains('line-through')) lp.classList.add('line-through'); lp.textContent = `$${LISTING_PRICE.toFixed(2)}`; $('discountLine').textContent = `${pct.toFixed(0)}% below listing`; }
  calcTokens(price);
}
function calcTokens(price){
  const usd = parseFloat($('usdIn').value || '0');
  const tokens = isFinite(usd/price) ? (usd/price) : 0;
  $('tokensOut').textContent = tokens.toFixed(2);
}
$('usdIn').addEventListener('input', ()=> {
  const p = parseFloat($('calcPrice').textContent.replace('$','')) || LISTING_PRICE;
  calcTokens(p);
});

/* Render Phase schedule table */
function shortRange(start, end){
  const s = new Date(start), e = new Date(end);
  const fmtS = primaryUTC ? s.toLocaleString([], { month:'short', day:'2-digit', timeZone:'UTC'}) : s.toLocaleString([], { month:'short', day:'2-digit'});
  const fmtE = primaryUTC ? e.toLocaleString([], { month:'short', day:'2-digit', timeZone:'UTC'}) : e.toLocaleString([], { month:'short', day:'2-digit'});
  return `${fmtS} → ${fmtE}`;
}
function renderPhaseTable(){
  const now = nowAccurate();
  const wrap = $('phaseTable');
  wrap.innerHTML = '';
  PHASES.forEach(p=>{
    const row = document.createElement('div');
    row.className = 'row text-sm';
    const isNow = now >= new Date(p.start) && now <= new Date(p.end);
    row.innerHTML = `
      <div class="font-semibold">${p.name} ${isNow?'<span class="badge badge-now">Now</span>':''}</div>
      <div class="opacity-90">$${p.price.toFixed(2)}</div>
      <div class="small-dim">${shortRange(p.start, p.end)}</div>
    `;
    wrap.appendChild(row);
  });
}

/* Main loop: countdown + progress + phase + pricing */
let lastSecond=-1;
function loop(){
  const now = nowAccurate();
  const ph = currentPhase(now);

  // Phase label + phase name
  phaseLabel.innerHTML = `Presale ${ph.pre?'begins':ph.post?'ended':'ends'} in — <span>${primaryUTC?'UTC':'Local'}</span>`;
  phaseNameEl.textContent = `Phase: ${ph.pre?'Upcoming':ph.post?'Ended':ph.name}`;

  // Countdown target
  const target = ph.pre ? new Date(PHASES[0].start)
                : ph.post ? now
                : new Date(ph.end);

  // Countdown render
  const diff = Math.max(0, target-now); const s=Math.floor(diff/1000);
  if(s!==lastSecond){ lastSecond=s; const d=Math.floor(s/86400),h=Math.floor((s%86400)/3600),m=Math.floor((s%3600)/60),ss=s%60; countdown.replaceChildren(box(d,'d'),box(h,'h'),box(m,'m'),box(ss,'s')); }

  // Progress within current phase + ETA
  let pct=0, etaText='';
  if(ph.pre){ pct=0; etaText = `Starts ${fmtUTC(new Date(PHASES[0].start))}`; $('phaseDates').textContent = `Next: ${fmtUTC(new Date(PHASES[0].start))} → ${fmtUTC(new Date(PHASES[0].end))}`; setPriceCard(PHASES[0].price, PHASES[0].name, false, true); }
  else if(ph.post){ pct=100; etaText='Ended'; $('phaseDates').textContent = `TGE & listing from ${fmtUTC(PRESALE_END)}`; setPriceCard(LISTING_PRICE, 'Listing', true, false); }
  else{
    const sT=new Date(ph.start), eT=new Date(ph.end);
    pct = clamp01((now - sT)/(eT - sT))*100;
    const endIn=Math.max(0,eT-now); const hrs=Math.floor(endIn/36e5), mins=Math.floor((endIn%36e5)/6e4);
    etaText=`Ends in ${hrs}h ${String(mins).padStart(2,'0')}m`;
    $('phaseDates').textContent = `${ph.name}: ${fmtUTC(sT)} → ${fmtUTC(eT)}`;
    setPriceCard(ph.price, ph.name, false, false);
  }
  $('phaseBar').style.width=`${pct}%`;
  $('phaseEta').textContent = etaText;

  requestAnimationFrame(loop);
}

/* Sticky CTA timing */
const SHOW_BAR_DAYS = 14;
function toggleBar(){
  const days=(PRESALE_START - new Date())/86400000;
  document.getElementById('stickyCTA').classList.toggle('hidden', !(window.innerWidth < 768 && days>0 && days<=SHOW_BAR_DAYS));
}

/* smooth anchors */
document.querySelectorAll('a[href^="#"]').forEach(a=>{
  a.addEventListener('click', e=>{
    const id=a.getAttribute('href').slice(1); const el=document.getElementById(id); if(!el) return;
    e.preventDefault(); el.scrollIntoView({behavior:'smooth', block:'start'}); history.replaceState(null,'','#'+id);
  });
});

/* Active nav highlight */
const navLinks = [...document.querySelectorAll('nav a[href^="#"]')];
const navMap = navLinks.map(a=>({a, id:a.getAttribute('href').slice(1)}));
const secIO = new IntersectionObserver(es=>{
  es.forEach(e=>{
    const hit = navMap.find(n=>n.id===e.target.id);
    if(hit && e.isIntersecting){
      navMap.forEach(n=>n.a.classList.remove('text-white'));
      hit.a.classList.add('text-white');
    }
  });
},{ rootMargin:'-45% 0px -45% 0px', threshold:0.01 });
navMap.forEach(n=>{ const el=document.getElementById(n.id); el && secIO.observe(el); });

/* Reveal-on-scroll */
(function(){
  const els = document.querySelectorAll('.reveal');
  els.forEach(el => { el.style.opacity=0; el.style.transform='translateY(12px)'; el.style.transition='opacity .5s ease, transform .5s ease'; });
  const io = new IntersectionObserver(entries=>{
    entries.forEach((e)=>{
      if(e.isIntersecting){
        e.target.style.opacity=1; e.target.style.transform='translateY(0)';
        e.target.style.transitionDelay = (Number(e.target.dataset.delay)||0)+'ms';
        io.unobserve(e.target);
      }
    });
  }, {threshold:.12});
  els.forEach(el=>io.observe(el));
})();

/* ===== Formspree (AJAX) ===== */
const FORMSPREE_ENDPOINT = 'https://formspree.io/f/mandalyp';
async function postFormspree(data){
  const ctrl = new AbortController();
  const t = setTimeout(()=>ctrl.abort(), 10000);
  try{
    const res=await fetch(FORMSPREE_ENDPOINT,{ method:'POST', headers:{ 'Content-Type':'application/json', 'Accept':'application/json' }, body: JSON.stringify(data), signal: ctrl.signal });
    if(!res.ok) throw new Error('Bad response'); return res.json().catch(()=>({}));
  } finally { clearTimeout(t); }
}
const notifyForm=$('notifyForm'), notifyMsg=$('notifyMsg'), notifySuccess=$('notifySuccess');
const email = document.getElementById('email');
email?.addEventListener('input', ()=>{
  const ok = email.checkValidity();
  email.classList.toggle('is-valid', ok);
  email.classList.toggle('is-invalid', !ok && email.value.length>0);
});
if (notifyForm){
  notifyForm.addEventListener('submit', async (e)=>{
    e.preventDefault(); notifyMsg.classList.add('hidden');
    const fd=new FormData(notifyForm); const trap=(fd.get('company')||'').trim(); if(trap) return;
    try{
      notifyForm.setAttribute('aria-busy','true');
      await postFormspree(Object.fromEntries(fd.entries()));
      notifyForm.classList.add('hidden'); notifySuccess.classList.remove('hidden');
      toast('Check your email to confirm ✉️');
    } catch(err){
      notifyMsg.textContent='Submission failed. Please check your connection and try again.'; notifyMsg.classList.remove('hidden');
      toast('Submission failed. Try again.', true);
    } finally {
      notifyForm.removeAttribute('aria-busy');
    }
  });
}
if(location.hash==='#notify-success'){ notifyForm?.classList.add('hidden'); notifySuccess?.classList.remove('hidden'); }

/* ===== ENS-aware allowlist ===== */
const wlForm=$('wlForm'), wlMsg=$('wlMsg'), wlHelp=$('wlHelp'), wlSuccess=$('wlSuccess');
const addrRe=/^0x[a-fA-F0-9]{40}$/; const ensRe=/^[a-z0-9-]+(\.[a-z0-9-]+)*\.eth$/i;
function setHelp(text, ok=false){ wlHelp.textContent=text||''; wlHelp.style.color= ok ? 'var(--muted)' : 'var(--dim)'; }

let providerENS = null;
if (window.ethers?.providers?.JsonRpcProvider) {
  providerENS = new window.ethers.providers.JsonRpcProvider('https://cloudflare-eth.com');
}
let ensTimer=null;
async function resolveIfEns(value){
  if(!value || !ensRe.test(value) || value.length>255) return null;
  if(!providerENS?.resolveName) return null;
  try{
    const ctrl=new AbortController(); const timeout=setTimeout(()=>ctrl.abort(),10000);
    const resolved = await providerENS.resolveName(value); clearTimeout(timeout);
    return resolved||null;
  }catch{ return null; }
}

if (wlForm){
  const walletInput=$('wallet');
  walletInput.addEventListener('input', ()=>{
    wlMsg.classList.add('hidden');
    const v=walletInput.value.trim();
    if(!v){ setHelp(''); return; }
    if(addrRe.test(v)){ setHelp('Looks like a valid Ethereum address.', true); return; }
    if(ensRe.test(v)){
      setHelp('Checking ENS…');
      clearTimeout(ensTimer);
      ensTimer = setTimeout(async ()=>{
        const addr=await resolveIfEns(v);
        setHelp(addr?`ENS resolved to ${addr.slice(0,6)}…${addr.slice(-4)}.`:'Could not resolve this ENS name.', !!addr);
      }, 200);
      return;
    }
    setHelp('Enter a valid 0x… address or an ENS name like yourname.eth');
  });

  wlForm.addEventListener('submit', async (e)=>{
    e.preventDefault(); wlMsg.classList.add('hidden');
    const fd=new FormData(wlForm); const trap=(fd.get('company')||'').trim(); let wallet=(fd.get('wallet')||'').trim(); if(trap) return;
    let finalAddr=null;
    if(addrRe.test(wallet)){ finalAddr=wallet; }
    else if(ensRe.test(wallet)){
      wlHelp.textContent='Resolving ENS…';
      const resolved=await resolveIfEns(wallet);
      if(resolved) finalAddr=resolved; else { wlMsg.textContent='Enter a valid address, or a resolvable ENS name.'; wlMsg.classList.remove('hidden'); return; }
    } else { wlMsg.textContent='Enter a valid 0x… address or ENS name (yourname.eth).'; wlMsg.classList.remove('hidden'); return; }
    try{
      const list=JSON.parse(safeGet('etrx_wl','[]')||'[]'); if(!list.includes(finalAddr)) list.push(finalAddr);
      safeSet('etrx_wl', JSON.stringify(list));
      await postFormspree({ wallet: finalAddr, type: 'allowlist' });
      wlForm.classList.add('hidden'); wlSuccess.classList.remove('hidden');
      toast('Wallet submitted ✅');
    }catch(err){
      wlMsg.textContent='Saved locally. Network submit failed — please try again later.'; wlMsg.classList.remove('hidden');
      toast('Saved locally. Network error.', true);
    }
  });
}

/* ===== Injected wallet (EIP-6963 aware) ===== */
let activeProvider=null;
function shortAddr(a){ return a ? `${a.slice(0,6)}…${a.slice(-4)}` : ''; }

/* Modal open/close + focus trap */
let lastFocus=null;
function setModalInert(on){ if(on){ modal.removeAttribute('inert'); } else { modal.setAttribute('inert',''); } }
function showModal(show){
  if(show){
    lastFocus = document.activeElement;
    modal.classList.remove('hidden'); modal.classList.add('flex'); setModalInert(true);
    const f = modal.querySelector('button, [href], input, [tabindex]:not([tabindex="-1"])');
    f?.focus();
  } else {
    modal.classList.add('hidden'); modal.classList.remove('flex'); setModalInert(false);
    lastFocus?.focus();
  }
}
function openModal(){ discoverInjected(); showModal(true); }
;[connectBtn, openConnect].forEach(btn=> btn?.addEventListener('click', openModal));
modalClose.addEventListener('click', ()=> showModal(false));
modal.addEventListener('click', (e)=>{ if(e.target===modal) showModal(false); });

document.addEventListener('keydown', (e)=>{
  if(!modal.classList.contains('flex')) return;
  const nodes = modal.querySelectorAll('button, [href], input, [tabindex]:not([tabindex="-1"])');
  if (!nodes.length) return;
  const first = nodes[0], last = nodes[nodes.length-1];
  if(e.key === 'Tab'){
    if(e.shiftKey && document.activeElement===first){ e.preventDefault(); last.focus(); }
    else if(!e.shiftKey && document.activeElement===last){ e.preventDefault(); first.focus(); }
  } else if(e.key === 'Escape'){ showModal(false); }
});

async function ensureMainnet(provider, hexChain='0x1'){
  try{
    const current=await provider.request({ method:'eth_chainId' });
    if(current?.toLowerCase()===hexChain.toLowerCase()) return true;
    await provider.request({ method:'wallet_switchEthereumChain', params:[{ chainId: hexChain }] });
    return true;
  } catch(err){ console.warn('Chain switch failed', err); toast('Please switch to Ethereum Mainnet in your wallet.', true); return false; }
}

function discoverInjected(){
  walletList.innerHTML = '';
  const entries = [];
  const announced = [];
  function onAnnounce(e){ announced.push(e.detail); }
  window.addEventListener('eip6963:announceProvider', onAnnounce, { once:false });
  window.dispatchEvent(new Event('eip6963:requestProvider'));

  if (window.ethereum){
    const providers = window.ethereum.providers?.length ? window.ethereum.providers : [window.ethereum];
    providers.forEach(p=>{
      const name = p.isMetaMask ? 'MetaMask' : p.isBraveWallet ? 'Brave Wallet' : p.isRabby ? 'Rabby' : p.isFrame ? 'Frame' : 'Browser Wallet';
      entries.push({ name, provider:p });
    });
  }
  setTimeout(()=>{
    const merged = announced.length ? announced.map(({info,provider})=>({name:info?.name||'Browser Wallet', provider})) : entries;
    if(!merged.length){
      const el = document.createElement('div');
      el.className = 'small-dim';
      el.textContent = 'No browser wallet detected.';
      walletList.appendChild(el);
      return;
    }
    merged.forEach(({name,provider})=>{
      const btn=document.createElement('button');
      btn.className='btn-ghost text-left flex items-center justify-between';
      btn.setAttribute('role','listitem');
      btn.innerHTML=`<span>🧩 ${name}</span><span class="small-dim">Use extension</span>`;
      btn.addEventListener('click', async ()=>{
        showModal(false);
        try{
          const accounts=await provider.request({ method:'eth_requestAccounts' });
          await onConnected(provider, accounts?.[0]||null);
        }catch(err){ console.warn('Injected connect error', err); toast('Could not connect to wallet.', true); }
      });
      walletList.appendChild(btn);
    });
  }, 350);
}

function removeProviderListeners(){
  if(!activeProvider?.removeListener) return;
  activeProvider.removeListener('accountsChanged', onAccountsChanged);
  activeProvider.removeListener('disconnect', onDisconnect);
  activeProvider.removeListener('chainChanged', onChainChanged);
}
function onAccountsChanged(accs){ walletShort.textContent=shortAddr(accs?.[0]||''); safeSet('etrx_wallet', accs?.[0]||''); }
function onDisconnect(){ doDisconnect(); }
async function onChainChanged(){ await ensureMainnet(activeProvider); }

async function onConnected(provider, account){
  if(activeProvider && provider!==activeProvider){ removeProviderListeners(); }
  activeProvider = provider;
  await ensureMainnet(provider);
  safeSet('etrx_wallet', account||'');
  walletShort.textContent = shortAddr(account||'');
  walletPill.classList.remove('hidden');
  connectBtn.classList.add('hidden-important');
  openConnect?.classList.add('hidden-important');
  provider.on?.('accountsChanged', onAccountsChanged);
  provider.on?.('disconnect', onDisconnect);
  provider.on?.('chainChanged', onChainChanged);
  toast('Wallet connected ✅');
}
function doDisconnect(){
  try{ activeProvider?.disconnect?.(); }catch{}
  removeProviderListeners();
  activeProvider=null; safeSet('etrx_wallet','');
  walletPill.classList.add('hidden');
  connectBtn.classList.remove('hidden-important');
  openConnect?.classList.remove('hidden-important');
  toast('Disconnected', true);
}
disconnectBtn.addEventListener('click', doDisconnect);

/* Restore previous wallet session */
const prev = safeGet('etrx_wallet','');
if (prev){
  walletShort.textContent = shortAddr(prev);
  walletPill.classList.remove('hidden');
  connectBtn.classList.add('hidden-important');
  openConnect?.classList.add('hidden-important');
}

/* Share */
const shareBtn=$('shareLaunch');
if (shareBtn && navigator.share){
  shareBtn.addEventListener('click', async ()=>{
    try{ await navigator.share({ title:'$ETRX • Etheria Presale', text:'Presale runs Sep 24 → Oct 1 (UTC). Join the allowlist.', url: location.href }); }catch{}
  });
}else if(shareBtn){
  shareBtn.addEventListener('click', ()=>{
    navigator.clipboard.writeText(location.href);
    shareBtn.textContent='Link copied!';
    setTimeout(()=>shareBtn.textContent='Share this launch', 1500);
  });
}

/* Toast */
function toast(msg, isWarn=false){
  const t=document.createElement('div');
  t.setAttribute('role','status'); t.setAttribute('aria-live','polite'); t.setAttribute('aria-atomic','true');
  t.className='toast fixed bottom-6 left-1/2 -translate-x-1/2 px-3 py-2 rounded-lg glass card text-sm';
  t.style.borderColor = isWarn ? 'rgba(255,99,99,.35)' : 'var(--ring)';
  t.textContent=msg; document.body.appendChild(t);
  setTimeout(()=>{ t.style.opacity='0'; t.style.transition='opacity .25s'; t.addEventListener('transitionend', ()=>t.remove(), {once:true}); }, 2000);
}

/* ===== Etheria Wisps ===== */
(function(){
  const canvas=document.getElementById('wispCanvas'); if(!canvas) return;
  if (navigator?.connection?.saveData) return;
  if (matchMedia('(prefers-reduced-motion: reduce)').matches) return;

  const ctx=canvas.getContext('2d');
  let w=0,h=0,dpr=1, wisps=[];

  function resize(){
    dpr = Math.min(devicePixelRatio||1,2);
    w = canvas.width = Math.floor(innerWidth*dpr);
    h = canvas.height= Math.floor(innerHeight*dpr);
    canvas.style.width=innerWidth+'px'; canvas.style.height=innerHeight+'px';
    makeWisps();
  }
  function rand(a,b){ return a + Math.random()*(b-a) }
  function makeWisps(){
    const base = Math.min(120, Math.round((innerWidth*innerHeight)/50000));
    wisps = new Array(base).fill(0).map(()=>({
      x: rand(0,w), y: rand(h*0.55, h*1.05),
      r: rand(2*dpr, 5*dpr),
      vx: rand(-0.05,0.05)*dpr, vy: rand(-0.15,-0.05)*dpr,
      huePick: Math.random(),
      tw: rand(0, Math.PI*2), tws: rand(0.005,0.012)
    }));
  }
  function col(u){
    if(u<0.5) return `rgba(84,178,255,${0.18 + u*0.25})`;
    if(u<0.75) return `rgba(208,128,255,${0.18 + (u-0.5)*0.2})`;
    return `rgba(255,147,76,${0.16 + (u-0.75)*0.18})`;
  }
  function draw(){
    ctx.clearRect(0,0,w,h);
    for(const p of wisps){
      p.tw += p.tws;
      const a = 0.5 + Math.sin(p.tw)*0.5;
      p.x += p.vx + Math.sin(p.y*0.001)*0.12*dpr;
      p.y += p.vy;
      if(p.y < -20) { p.y = h + 10; p.x = rand(0,w); }
      if(p.x < -10) p.x = w+10; if(p.x > w+10) p.x = -10;
      const grad = ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*4);
      grad.addColorStop(0, col(p.huePick));
      grad.addColorStop(1, 'rgba(0,0,0,0)');
      ctx.globalCompositeOperation = 'lighter';
      ctx.fillStyle = grad;
      ctx.beginPath(); ctx.arc(p.x,p.y,p.r*(2.5+a*1.2),0,Math.PI*2); ctx.fill();
      ctx.globalCompositeOperation = 'source-over';
    }
    requestAnimationFrame(draw);
  }
  resize(); draw();
  addEventListener('resize', resize, {passive:true});
})();

/* ===== Pointer-follow glow for .holo ===== */
(function(){
  const cards = document.querySelectorAll('.holo');
  cards.forEach(el=>{
    el.addEventListener('pointermove', e=>{
      const r = el.getBoundingClientRect();
      el.style.setProperty('--mx', (e.clientX - r.left) + 'px');
      el.style.setProperty('--my', (e.clientY - r.top) + 'px');
    });
  });
})();

/* Initialize UI */
renderPhaseTable();
updateWhen();
toggleBar();
setInterval(toggleBar, 60_000);

/* Main loop start */
loop();

/* ===== FAQ expand ===== */
document.querySelectorAll('.faq-item')?.forEach(item=>{
  const btn=item.querySelector('.faq-header'); const body=item.querySelector('.faq-body'); const chev=item.querySelector('.faq-chevron');
  btn.addEventListener('click', ()=>{
    const open=btn.getAttribute('aria-expanded')==='true';
    btn.setAttribute('aria-expanded', String(!open));
    if(!open){
      item.classList.add('open'); body.hidden=false; body.style.maxHeight=body.scrollHeight+'px'; body.classList.add('open'); chev.style.transform='rotate(180deg)';
    } else {
      body.style.maxHeight=body.scrollHeight+'px';
      requestAnimationFrame(()=>{ body.style.maxHeight='0px'; body.classList.remove('open'); chev.style.transform='rotate(0deg)'; });
      body.addEventListener('transitionend', ()=>{ if(body.style.maxHeight==='0px') body.hidden=true; item.classList.remove('open'); }, {once:true});
    }
  });
});
</script>
</body>
</html>
